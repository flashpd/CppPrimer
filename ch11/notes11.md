# 第十一章 关联容器

关联容器支持高效的关键字查找和访问。两个主要的关联容器类型是`map`和`set`。

| 关联容器类型 |                                  |
| ------------ | -------------------------------- |
| map          | 关联数组：保存关键字-值对        |
| set          | 关键字即值，即只保存关键字的容器 |
| multimap     | 关键字可重复出现的map            |
| multiset     | 关键字可重复出现的set            |

| 无序集合           |                                   |
| ------------------ | --------------------------------- |
| unordered_map      | 用哈希函数组织的map               |
| unordered_set      | 用哈希函数组织的set               |
| unordered_multimap | 哈希组织的map：关键字可以重复出现 |
| unordered_multiset | 哈希组织的set：关键字可以重复出现 |

## 11.2 关联容器概述

### 关键字类型的要求

无论我们怎么定义比较函数，它都必须具备如下基本性质：

- 两个关键字不能同时“小于等于”对方；如果k1“小于等于”k2，那么k2绝不能“小于等于”k1.
- 如果k1“小于等于”k2，且k2“小于等于”k3，那么k1必须“小于等于”k3。
- 如果存在两个关键字，任何一个都不“小于等于”另一个，那么我们称这两个关键字是“等价”的。如果k1“等价于”k2，且k2“等价于”k3，那么k1必须“等价于”k3。

如果两个关键字是等价的（即，任何一个都不“小于等于”另一个），那么容器将提摩太视作相等来处理。当用作`map`的关键字时，只能有一个元素与这两个关键字关联，我们可以用两者中任意一个来访问对应的值。

### pair类型

定义在头文件`utility`中

| pair操作               |                                                              |
| ---------------------- | ------------------------------------------------------------ |
| pair<T1, T2> p         | p是一个pair，两个类型分别为T1和T2的成员都进行了值初始化      |
| pair<T1, T2> p(v1, v2) | p是一个成员类型为T1和T2的pair；first和second成员分布用v1和v2初始化 |
| pair<T1, T2>p={v1, v2} | 同上                                                         |
| make_pair(v1, v2)      | 返回一个用v1和v2初始化的pair。pair的类型从v1和v2类型推断出来 |
| p.first                | 返回p的名为first的（公有）数据成员                           |
| p.second               | 返回p的名为second的（公有）数据成员                          |
| p1 relop p2            | 关系运算符（<、>、<=、>=）按字典顺序                         |
| p1 == p2               | 当first和second成员分别相等时，两个pair相等。相等性判断利用元素的==运算符实现 |
| p1 != p2               | 同上                                                         |



### 11.3 关联容器操作

| 类型别名    |                                                              |
| ----------- | ------------------------------------------------------------ |
| key_type    | 此容器的关键字类型                                           |
| mapped_type | 每个关键字关联的类型；只适用于map                            |
| value_type  | 对于set，与key_type相同，                                                                                     对于map，为pair<const key_type, mapped_type> |

### 关联容器迭代器

必须记住，一个map的`value_type`是一个pair，我们可以改变`pair`的值，但不能改变关键字成员的值。

`set`的迭代器是`const`的

### 添加元素

向一个`map`进行`insert`操作时，必须记住元素类型是`pair`。

```cpp
word_count.insert({word, 1});
word_count.insert(make_pair(word, 1));
word_count.insert(pair<string, size_t>(word, 1));
word_count.insert(map<string, size_t>::value_type(word, 1));
```

